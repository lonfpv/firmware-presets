#$ TITLE: LonFPV common settings
#$ FIRMWARE_VERSION: 4.3
#$ CATEGORY: OTHER
#$ STATUS: COMMUNITY
#$ KEYWORDS: defaults, reset, mode, modes, adjustments, aux, switch
#$ AUTHOR: LonFPV (Rich Blomseth)
#$ DESCRIPTION: Common Betaflight configuration shared with 1.6" to 5" builds
#$ DESCRIPTION: TBD -- Customize with build-specific script and optionally LED and GPS configuration scripts

# -- Features --
feature -AIRMODE
feature -MOTOR_STOP
feature TELEMETRY
feature ESC_SENSOR

# -- Beeper Settings --
beeper -GYRO_CALIBRATED
beeper -DISARMING
beeper -ARMING
beeper -ACC_CALIBRATION
beeper -READY_BEEP
beeper -DISARM_REPEAT
beeper -ARMED
beeper -SYSTEM_INIT
beeper -ON_USB
beeper -CAM_CONNECTION_OPEN
beeper -CAM_CONNECTION_CLOSE

# -- Beacon Settings --
beacon RX_LOST
beacon RX_SET

# -- Map --
map TAER1234

# -- Report receive SNR for RSSI dBm --
set crsf_use_rx_snr = ON

# -- Throttle Range --
set min_check = 1020
set max_check = 1980

# -- FPV Angle Mix --
# FPV mix degrees: Automatically coordinates roll and yaw
# Only active when FPV Angle Mix mode is active
# JB recommends 50% of camera uptilt
# Invalid name in Betaflight 4.3
# set fpv_mix_degrees = 10
# From 4.1 documentation: 
# BF Configurator: FPV Camera Angle [degrees]
# Camera tilt angle in degrees that should be compensated 
# for when enabling FPV Angle Mix mode. It can be used to 
# fly FPV as if the camera was tilted differently. 
# Also known as uptilt compensation.

# -- Receiver --
set serialrx_provider = CRSF

# -- Master --
set dshot_idle_value = 450
set dshot_bidir = ON
# DSHOT600 required for 8K PID loop
set motor_pwm_protocol = DSHOT600
set failsafe_delay = 9
set vbat_max_cell_voltage = 435
set vbat_full_cell_voltage = 410
set vbat_min_cell_voltage = 330
set vbat_warning_cell_voltage = 350
set vbat_hysteresis = 1
set yaw_motors_reversed = ON
set small_angle = 180
set deadband = 2
# Denominator for Gyro Update Frequency / PID Loop Frequency (1 for 8K; 2 for 4K)
set pid_process_denom = 1

# -- Rates --
# profile 0
profile 0
set vbat_sag_compensation = 100
set iterm_relax_cutoff = 20

# rateprofile 0
rateprofile 0
set thr_mid = 40
set thr_expo = 65
set rates_type = ACTUAL
set roll_rc_rate = 4
set pitch_rc_rate = 4
set yaw_rc_rate = 4
set roll_expo = 100
set pitch_expo = 100
set yaw_expo = 100
set roll_srate = 40
set pitch_srate = 40
set yaw_srate = 40
set throttle_limit_type = SCALE
set throttle_limit_percent = 84

# rateprofile 1
rateprofile 1
set thr_mid = 40
set thr_expo = 65
set rates_type = ACTUAL
set roll_rc_rate = 8
set pitch_rc_rate = 8
set yaw_rc_rate = 8
set roll_expo = 100
set pitch_expo = 100
set yaw_expo = 100
set roll_srate = 46
set pitch_srate = 46
set yaw_srate = 46
set throttle_limit_type = SCALE
set throttle_limit_percent = 85

# rateprofile 2
rateprofile 2
set thr_mid = 40
set thr_expo = 65
set rates_type = ACTUAL
set roll_rc_rate = 14
set pitch_rc_rate = 14
set yaw_rc_rate = 14
set roll_expo = 100
set pitch_expo = 100
set yaw_expo = 100
set roll_srate = 90
set pitch_srate = 90
set yaw_srate = 90
set throttle_limit_type = SCALE
set throttle_limit_percent = 90

# default rateprofile
rateprofile 0
